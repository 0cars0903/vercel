# Clause Lens v1.0  
**로컬 환경 최적화 다중 에이전트 계약서 분석 시스템 기술 설계서**

---

## 1 서론: 법률 계약의 접근성 격차

> **Clause Lens**는 바로 이러한 격차를 해소하기 위해 설계되었습니다. 누구나 법률 문서를 이해하고,  
스스로의 결정을 신뢰할 수 있도록 돕는 **로컬 최적화 다중 에이전트 시스템**입니다.

---

## 2 핵심 아키텍처: LangGraph 기반의 다중 에이전트 시스템

| 구성 요소 | 설명 |
|-----------|------|
| **LangGraph** | 에이전트 간 상태(State)와 전환 조건(Conditional Edge)을 그래프 형태로 설계하여, 복잡한 계약서 분석 흐름을 직관적으로 관리합니다. |
| **Supervisor 에이전트** | 초기 요청을 하위 태스크로 분해하고, 각 태스크를 적합한 전문 에이전트에게 위임하며 모든 결과물을 취합·검토합니다. |
| **Parser 에이전트** | 계약서 텍스트를 법률적 의미 단위로 분할하여 후속 분석의 전처리를 담당합니다. |
| **Clause Analysis 에이전트** | 조항별로 ‘의무·권리·금지·책임’을 유형 분류하고, 리스크 등급(‘높음·중간·낮음’)을 분석하여 구조화된 JSON으로 출력합니다. |
| **OCR 에이전트** | 이미지 파일(JPG, PNG)을 텍스트로 변환하며, Supervisor의 지시에 따라 조건부로 호출됩니다. |
| **Report Writer 에이전트** | 구조화된 분석 결과를 이해하기 쉬운 보고서로 변환하여 사용자에게 제공합니다. |

> **LangGraph**를 통해 각 에이전트가 **명확한 책임**을 가지며,  
**동적 하이라이팅·조건부 흐름 분기**를 통해 사용자가 필요로 하는 정보에 즉각 접근할 수 있습니다.

---
# 
## 3 Front-End 구현 계획 

| 주요 기능                | 설명                                                                                      |
|-------------------------|-------------------------------------------------------------------------------------------|
| **Next.js + Vercel**    | 최신 React 기반으로 빠른 로딩 속도와 SEO 최적화를 동시에 달성                             |
| **2-패널 디자인**       | 좌측 패널: 계약서 원문<br>우측 패널: AI 분석 결과<br>원문과 분석 내용을 즉각 대조 가능     |
| **인터랙티브 컴포넌트** | 동적 하이라이팅: 분석 결과 클릭 시 원문 하이라이트<br>리스크 색상 코딩: 빨강(높음), 노랑(중간), 파랑(정보성)<br>툴팁: 법률 용어에 쉬운 설명 제공 |
| **리스크 대시보드**     | 도넛 차트·막대그래프로 리스크 분포 시각화, 전체 안전도 빠른 진단                          |

---

## 4 Back-End: Notion API 기능을 활용한 데모 서비스 최적화

> 해커톤 환경의 시간·리소스 제약을 고려하여  
**복잡한 백엔드 인프라** 대신 **Notion 데이터베이스**를 백엔드 저장소로 활용합니다.  

> 이를 통해 **데모 안정성**을 높이고, **핵심 AI 로직** 개발에 집중할 수 있습니다.

| 단계 | 설명 | 주요 기술 |
|------|------|-----------|
| **1** | 사용자가 Next.js 프론트엔드에서 계약서 파일을 업로드합니다. | Next.js File Input |
| **2** | Vercel 서버리스 함수가 파일을 수신하고 고유 ID를 생성합니다. | Vercel Serverless Functions |
| **3** | LangGraph 에이전트 시스템을 백그라운드에서 실행합니다. | Node.js, LangGraph |
| **4** | 분석 결과를 구조화된 JSON 형태로 Notion 데이터베이스에 저장합니다. | Notion API |
| **5** | 프론트엔드에서 주기적으로 Notion API를 호출하여 결과를 조회합니다. | Axios (HTTP Polling) |
| **6** | 분석 완료 시 실시간 알림 또는 페이지 자동 업데이트를 통해 사용자에게 결과를 즉시 보여 줍니다. | React, Toast Notifications |

---
# 
## 5 하드웨어 최적화 전략: MacBook Air M4 (24GB RAM)

> ##### **로컬 기반 실행의 핵심 목표**  
> 모든 AI 에이전트 과정을 **온전히 로컬 머신**에서 실행하여
> **네트워크 의존성을 최소화**하고, **데이터 보안**과 **응답 속도**를 극대화합니다.

| 모델 | 파라미터 규모 | 4비트 양자화 시 RAM 예상 점유율 | 주요 역할 |
|------|--------------|-----------------------------:|-----------|
| **mi:dm Base (11.5B)** | 115억 | 약 **12GB** | Supervisor, Clause Analysis |
| **qwen2.5 (7B)** | 70억 | 약 **4.7-7GB** | Parser, Report Writer |
| **mi:dm Mini (2.3B)** | 23억 | 약 **2-3GB** | OCR Agent |

> ##### **총 예상 메모리 사용량** : 12GB &#43; 7GB &#43; 3GB &#61; **22GB**  
>  **16-20GB** 가용 메모리 내 수용이 어려울 경우, **qwen2.5**를 더 경량화된 모델로 교체하여 안정성을 확보합니다.  

---
## <br> <br> <br> <br>  <br>  <br>

## 6 결론 및 전략적 로드맵

> ### MVP 개발 로드맵 (해커톤 48시간)
> 
> 1. **기반 구축** (0-8시간)  
> Ollama 환경 설정, LangGraph StateGraph 정의, Supervisor·Clause Analysis 에이전트 구현  
> 2. **도구 통합 및 입력 처리** (8-20시간)  
>    File Handler·PDF Parser·OCR 도구 작성, Parser·OCR 에이전트 파이프라인 구축  
> 3. **UI 개발 및 백엔드 연동** (20-36시간)  
>    2-패널 뷰·인터랙티브 컴포넌트·실시간 스트리밍 기능 구현  
> 4. **최종 통합 및 데모 준비** (36-48시간)  
>    Report Writer 에이전트, Notion API 연동, 엔드투엔드 테스트 및 데모 시나리오 준비 

> ### 향후 Value-Up Points
> 1. **검색 증강 생성(RAG) 도입**  
>   한국 법률 조항·판례를 포함한 벡터 데이터베이스 구축으로 **법적 신뢰도** 강화  
> 2. **지원 계약서 유형 확대**  
>   주택임대차계약서에서 **근로계약서·용역계약서**로 단계적 확대  
> 3. **누락 조항 탐지 및 대안 제시**  
>   필수 보호 조항 누락 감지, 불리한 조항 대체 추천 기능 추가로 **더욱 능동적인 사용자 지원** 제공  

---

# Appendix: 
 
##### GPT-4o Custom 모델(beta) 활용 프로세스

## 1. 개발 방법론 개요
> 본 기획서는 해커톤 대회 규칙에 따라  
> **K-Studio의 GPT-4o 기반 Custom 모델**을 활용한 프롬프트 엔지니어링 방법론으로 작성되었습니다.

## 2. 프롬프트 엔지니어링 프로세스

### 단계 1: 프롬프트 설계 (Claude 활용)

	- System Prompt 설계: Clause Lens 전용 기술 설계서 작성자 페르소나 정의
	
	- User Prompt 시리즈 설계: 
		6개 섹션별 상세 프롬프트 작성
		CSS 디자인 최적화 지침 작성

### 단계 2: K-Studio 실행 (GPT-4o Custom 모델)

	- 변수 설정 : Temperature (0.7), Top p (0.9)
	
	- 고정 System Prompt 설정
	
	- 순차적 User Prompt 입력을 통한 정보 축적:

		1. **서론: 법률 계약의 접근성 격차** (서사적 문제 정의)
		2. **핵심 아키텍처: LangGraph 기반의 다중 에이전트 시스템**
		3. **Front-End: 법률 리스크 탐색을 위한 사용자 중심 인터페이스**
		4. **Back-End: Notion API 기능을 활용한 데모 서비스 최적화**
		5. **하드웨어 최적화 전략: MacBook Air M4 (24GB RAM)**
		6. **결론 및 전략적 로드맵**
		7. 최종 통합 (CSS 호환 Markdown)

### 단계 3: 반복적 개선

	- 각 섹션별 결과 검토
	
	- 필요 시 User Prompt 수정 및 재실행
	
	- 최종 통합 문서 생성

### 단계 4: Markdown 문서에 CSS 디자인을 적용하여 PDF로 변환

	- Visual Studio code에서 기획서(Markdown)에 CSS 적용 후 PDF 변환 

## 3. [참고 자료 링크](https://github.com/0cars0903/-KT-K-intelligence-Hackerton)

전체 프롬프트 세트(PDF): 
  
    K_Studio_Prompt.pdf

K-Studio 실행 로그: 

    image_1.png

    image_2.png
    
    image_3.png